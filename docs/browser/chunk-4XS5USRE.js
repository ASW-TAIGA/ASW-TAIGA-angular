import{a as q,b as G,c as S,d as z,e as W,h as B,i as J,j as U,k as Y,p as H,q as K,s as Q}from"./chunk-UGDPF2HT.js";import{a as R}from"./chunk-NGVF4NNM.js";import{D as p,J as s,Ja as P,Na as E,O as w,S as x,Wa as $,Xa as A,Y as _,Z as V,Za as O,_ as k,_a as j,aa as c,ba as I,ca as L,da as o,ea as r,fa as C,ia as v,ka as h,la as d,na as a,oa as F,pa as u,qa as D,r as y,u as g,v as f,xa as T}from"./chunk-CUL4UXS2.js";var tt=(e,n)=>n.path;function et(e,n){if(e&1&&(o(0,"li")(1,"a",4),a(2),r()()),e&2){let t=n.$implicit;s(),_("routerLink",t.path),s(),u(" ",t.label," ")}}var M=class e{navItems=[{path:"statuses",label:"Statuses"},{path:"priorities",label:"Priorities"},{path:"severities",label:"Severities"},{path:"types",label:"Types"}];static \u0275fac=function(t){return new(t||e)};static \u0275cmp=w({type:e,selectors:[["app-settings-page"]],decls:10,vars:0,consts:[[1,"flex","flex-col","md:flex-row","gap-6","min-h-[calc(100vh-theme(spacing.24))]"],[1,"md:w-64","bg-white","p-4","rounded-lg","shadow"],[1,"text-xl","font-semibold","text-slate-700","mb-4"],[1,"flex-1","bg-white","p-6","rounded-lg","shadow"],["routerLinkActive","bg-indigo-100 text-indigo-700 font-semibold",1,"block","px-3","py-2","rounded-md","text-slate-600","hover:bg-slate-100","hover:text-slate-800","transition-colors",3,"routerLink"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"aside",1)(2,"h2",2),a(3,"Settings"),r(),o(4,"nav")(5,"ul"),I(6,et,3,2,"li",null,tt),r()()(),o(8,"div",3),C(9,"router-outlet"),r()()),t&2&&(s(6),L(i.navItems))},dependencies:[E,A,O,j],encapsulation:2})};var N=(e,n)=>({"border-red-500":e,"border-slate-300":n}),it=(e,n)=>n.id;function nt(e,n){if(e&1&&(o(0,"p",5),a(1),r()),e&2){let t=d();s(),u("Loading ",t.title.toLowerCase(),"...")}}function ot(e,n){if(e&1&&(o(0,"div",6),a(1),r()),e&2){let t=d(2);s(),u(" ",t.error()," ")}}function lt(e,n){if(e&1&&(o(0,"p",7),a(1),r()),e&2){let t=d();s(),D("No ",t.title.toLowerCase(),' found. Click "Add ',t.itemLabel,'" to create one.')}}function st(e,n){e&1&&(o(0,"th",13),a(1,"Color"),r())}function rt(e,n){e&1&&(o(0,"th",13),a(1,"Name"),r())}function at(e,n){e&1&&(o(0,"th",13),a(1,"Slug"),r())}function dt(e,n){e&1&&(o(0,"th",13),a(1,"Is Closed?"),r())}function mt(e,n){e&1&&(o(0,"th",13),a(1,"Order"),r())}function ct(e,n){if(e&1&&(o(0,"td",15),C(1,"span",21),r()),e&2){let t=d().$implicit;s(),V("background-color",t.color||"#transparent")}}function pt(e,n){if(e&1&&(o(0,"td",16),a(1),r()),e&2){let t=d().$implicit;s(),F(t.name)}}function ut(e,n){if(e&1&&(o(0,"td",17),a(1),r()),e&2){let t=d().$implicit,i=d(3);s(),F(i.isIssueStatus(t)?t.slug:"N/A")}}function _t(e,n){if(e&1&&(o(0,"span",22),a(1),r()),e&2){let t=d(2).$implicit;_("ngClass",t.is_closed?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),s(),u(" ",t.is_closed?"Yes":"No"," ")}}function xt(e,n){e&1&&a(0," N/A ")}function gt(e,n){if(e&1&&(o(0,"td",17),x(1,_t,2,2,"span",22)(2,xt,1,0),r()),e&2){let t=d().$implicit,i=d(3);s(),c(i.isIssueStatus(t)?1:2)}}function ft(e,n){if(e&1&&(o(0,"td",17),a(1),r()),e&2){let t=d().$implicit;s(),F(t.order)}}function Ct(e,n){if(e&1){let t=v();o(0,"tr"),x(1,ct,2,2,"td",15)(2,pt,2,1,"td",16)(3,ut,2,1,"td",17)(4,gt,3,1,"td",17)(5,ft,2,1,"td",17),o(6,"td",18)(7,"button",19),h("click",function(){let l=g(t).$implicit,m=d(3);return f(m.openFormModal(l))}),a(8,"Edit"),r(),o(9,"button",20),h("click",function(){let l=g(t).$implicit,m=d(3);return f(m.openDeleteConfirmModal(l))}),a(10,"Delete"),r()()()}if(e&2){let t=d(2),i=d();s(),c(i.hasField("color")?1:-1),s(),c(i.hasField("name")?2:-1),s(),c(t.settingType==="statuses"&&i.hasField("slug")?3:-1),s(),c(t.settingType==="statuses"&&i.hasField("is_closed")?4:-1),s(),c(i.hasField("order")?5:-1)}}function ht(e,n){if(e&1&&(o(0,"div",8)(1,"table",11)(2,"thead",12)(3,"tr"),x(4,st,2,0,"th",13)(5,rt,2,0,"th",13)(6,at,2,0,"th",13)(7,dt,2,0,"th",13)(8,mt,2,0,"th",13),o(9,"th",13),a(10,"Actions"),r()()(),o(11,"tbody",14),I(12,Ct,11,5,"tr",null,it),r()()()),e&2){let t=d(),i=d();s(4),c(i.hasField("color")?4:-1),s(),c(i.hasField("name")?5:-1),s(),c(t.settingType==="statuses"&&i.hasField("slug")?6:-1),s(),c(t.settingType==="statuses"&&i.hasField("is_closed")?7:-1),s(),c(i.hasField("order")?8:-1),s(4),L(i.items())}}function bt(e,n){e&1&&(o(0,"p",34),a(1,"Name is required."),r())}function St(e,n){if(e&1&&(o(0,"div")(1,"label",31),a(2,"Name "),o(3,"span",32),a(4,"*"),r()(),C(5,"input",33),x(6,bt,2,0,"p",34),r()),e&2){let t,i,l=d(3);s(5),_("ngClass",T(2,N,((t=l.itemForm.get("name"))==null?null:t.invalid)&&((t=l.itemForm.get("name"))==null?null:t.touched),!((t=l.itemForm.get("name"))!=null&&t.invalid)||!((t=l.itemForm.get("name"))!=null&&t.touched))),s(),c((i=l.itemForm.get("name"))!=null&&i.hasError("required")&&((i=l.itemForm.get("name"))!=null&&i.touched)?6:-1)}}function vt(e,n){e&1&&(o(0,"p",34),a(1,"Color is required."),r())}function Ft(e,n){e&1&&(o(0,"p",34),a(1,"Color must be a valid hex code (e.g., #FF5733)."),r())}function yt(e,n){if(e&1&&(o(0,"div")(1,"label",35),a(2,"Color "),o(3,"span",32),a(4,"*"),r()(),o(5,"div",36),C(6,"input",37)(7,"input",38),r(),x(8,vt,2,0,"p",34)(9,Ft,2,0,"p",34),r()),e&2){let t,i,l,m=d(3);s(7),_("ngClass",T(3,N,((t=m.itemForm.get("color"))==null?null:t.invalid)&&((t=m.itemForm.get("color"))==null?null:t.touched),!((t=m.itemForm.get("color"))!=null&&t.invalid)||!((t=m.itemForm.get("color"))!=null&&t.touched))),s(),c((i=m.itemForm.get("color"))!=null&&i.hasError("required")&&((i=m.itemForm.get("color"))!=null&&i.touched)?8:-1),s(),c((l=m.itemForm.get("color"))!=null&&l.hasError("pattern")&&((l=m.itemForm.get("color"))!=null&&l.touched)?9:-1)}}function wt(e,n){e&1&&(o(0,"p",34),a(1,"Order is required."),r())}function It(e,n){e&1&&(o(0,"p",34),a(1,"Order must be a non-negative number."),r())}function Lt(e,n){if(e&1&&(o(0,"div")(1,"label",39),a(2,"Order "),o(3,"span",32),a(4,"*"),r()(),C(5,"input",40),x(6,wt,2,0,"p",34)(7,It,2,0,"p",34),r()),e&2){let t,i,l,m=d(3);s(5),_("ngClass",T(3,N,((t=m.itemForm.get("order"))==null?null:t.invalid)&&((t=m.itemForm.get("order"))==null?null:t.touched),!((t=m.itemForm.get("order"))!=null&&t.invalid)||!((t=m.itemForm.get("order"))!=null&&t.touched))),s(),c((i=m.itemForm.get("order"))!=null&&i.hasError("required")&&((i=m.itemForm.get("order"))!=null&&i.touched)?6:-1),s(),c((l=m.itemForm.get("order"))!=null&&l.hasError("min")&&((l=m.itemForm.get("order"))!=null&&l.touched)?7:-1)}}function Tt(e,n){e&1&&(o(0,"div",36),C(1,"input",41),o(2,"label",42),a(3,"Is this a closed state?"),r()(),o(4,"p",43),a(5,"Mark if this state means the item is closed/completed."),r())}function Et(e,n){if(e&1){let t=v();o(0,"div",23)(1,"div",24)(2,"h3",25),a(3),r(),o(4,"form",26),h("ngSubmit",function(){g(t);let l=d(2);return f(l.onSubmit())}),o(5,"div",27),x(6,St,7,5,"div")(7,yt,10,6,"div")(8,Lt,8,6,"div")(9,Tt,6,0),r(),o(10,"div",28)(11,"button",29),h("click",function(){g(t);let l=d(2);return f(l.closeFormModal())}),a(12," Cancel "),r(),o(13,"button",30),a(14),r()()()()()}if(e&2){let t=d(),i=d();k("opacity-100",i.showFormModal())("opacity-0",!i.showFormModal()),s(),k("scale-100",i.showFormModal())("scale-95",!i.showFormModal()),s(2),D(" ",i.isEditMode()?"Edit":"Add New"," ",t.itemLabel," "),s(),_("formGroup",i.itemForm),s(2),c(i.hasField("name")?6:-1),s(),c(i.hasField("color")?7:-1),s(),c(i.hasField("order")?8:-1),s(),c(t.settingType==="statuses"&&i.hasField("is_closed")?9:-1),s(4),_("disabled",i.itemForm.invalid),s(),u(" ",i.isEditMode()?"Save Changes":"Add "+t.itemLabel," ")}}function Mt(e,n){if(e&1){let t=v();o(0,"div",10)(1,"div",44)(2,"h3",45),a(3,"Confirm Deletion"),r(),o(4,"p",46),a(5),o(6,"strong",47),a(7),r(),a(8,"? "),r(),o(9,"p",48),a(10,"This action cannot be undone."),r(),o(11,"div",49)(12,"button",50),h("click",function(){g(t);let l=d(2);return f(l.closeDeleteConfirmModal())}),a(13," Cancel "),r(),o(14,"button",51),h("click",function(){g(t);let l=d(2);return f(l.confirmDeleteItem())}),a(15),r()()()()}if(e&2){let t=d(),i=d();s(5),u(" Are you sure you want to delete the ",t.itemLabel.toLowerCase()," "),s(2),u('"',i.itemToDeleteName(),'"'),s(5),_("disabled",i.isDeleting()),s(2),_("disabled",i.isDeleting()),s(),u(" ",i.isDeleting()?"Deleting...":"Delete "+t.itemLabel," ")}}function kt(e,n){if(e&1){let t=v();o(0,"div",1)(1,"div")(2,"h2",2),a(3),r(),o(4,"p",3),a(5),r()(),o(6,"button",4),h("click",function(){g(t);let l=d();return f(l.openFormModal())}),a(7),r()(),x(8,nt,2,1,"p",5)(9,ot,2,1,"div",6)(10,lt,2,2,"p",7)(11,ht,14,5,"div",8)(12,Et,15,17,"div",9)(13,Mt,16,5,"div",10)}if(e&2){let t,i=n,l=d();s(3),F(i.title),s(2),u("Add, remove, or edit the ",i.title.toLowerCase()," for your project."),s(2),u(" + Add ",i.itemLabel," "),s(),c(l.isLoading()?8:l.error()?9:(t=l.items())!=null&&t.length?11:10),s(4),c(l.showFormModal()?12:-1),s(),c(l.showDeleteConfirmModal()?13:-1)}}function Dt(e,n){e&1&&(o(0,"p",0),a(1,"Loading settings configuration..."),r())}var b=class e{route=y($);apiService=y(R);fb=y(K);config=p(null);items=p([]);isLoading=p(!0);error=p(null);showFormModal=p(!1);isEditMode=p(!1);currentItemId=p(null);itemForm;showDeleteConfirmModal=p(!1);itemToDeleteId=p(null);itemToDeleteName=p(null);isDeleting=p(!1);isIssueStatus(n){return"is_closed"in n}constructor(){this.route.data.subscribe(n=>{this.items.set([]),this.error.set(null),this.isLoading.set(!0),this.config.set(n),this.initializeForm(),this.loadItems()})}ngOnInit(){}initializeForm(){let n=this.config();if(!n)return;let t={};n.formFields.includes("name")&&(t.name=["",S.required]),n.formFields.includes("color")&&(t.color=["#CCCCCC",[S.required,S.pattern(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)]]),n.formFields.includes("order")&&(t.order=[10,[S.required,S.min(0)]]),n.formFields.includes("is_closed")&&(t.is_closed=[!1]),this.itemForm=this.fb.group(t)}loadItems(){let n=this.config();n&&(this.isLoading.set(!0),this.error.set(null),this.apiService.get(n.endpoint).subscribe({next:t=>{this.items.set(t.sort((i,l)=>(i.order??1/0)-(l.order??1/0)||(i.name??"").localeCompare(l.name??""))),this.isLoading.set(!1)},error:t=>{this.error.set(`Failed to load ${n.title.toLowerCase()}. Please try again.`),console.error(t),this.isLoading.set(!1)}}))}openFormModal(n){this.itemForm.reset();let t=this.config();if(!t)return;let i={};if(t.formFields.includes("name")&&(i.name=""),t.formFields.includes("color")&&(i.color="#CCCCCC"),t.formFields.includes("order")&&(i.order=(this.items()?.length+1)*10||10),t.formFields.includes("is_closed")&&(i.is_closed=!1),this.itemForm.patchValue(i),n){this.isEditMode.set(!0),this.currentItemId.set(n.id);let l={name:n.name,color:n.color||"#CCCCCC",order:n.order||10};this.isIssueStatus(n)&&t.formFields.includes("is_closed")&&(l.is_closed=n.is_closed||!1),this.itemForm.patchValue(l)}else this.isEditMode.set(!1),this.currentItemId.set(null);this.showFormModal.set(!0)}closeFormModal(){this.showFormModal.set(!1),this.itemForm.reset(),this.currentItemId.set(null),this.isEditMode.set(!1)}onSubmit(){if(this.itemForm.invalid){this.itemForm.markAllAsTouched();return}let n=this.config();if(!n)return;this.isDeleting.set(!1);let t=this.itemForm.value,i;this.isEditMode()&&this.currentItemId()?i=this.apiService.put(`${n.endpoint}${this.currentItemId()}/`,t):i=this.apiService.post(n.endpoint,t),i.subscribe({next:()=>{this.loadItems(),this.closeFormModal()},error:l=>{let m=l.error&&typeof l.error=="object"?JSON.stringify(l.error):l.message;alert(`Error saving ${n.itemLabel.toLowerCase()}: ${m||"Please try again."}`),console.error(l)}})}openDeleteConfirmModal(n){this.itemToDeleteId.set(n.id),this.itemToDeleteName.set(n.name),this.showDeleteConfirmModal.set(!0)}closeDeleteConfirmModal(){this.showDeleteConfirmModal.set(!1),this.itemToDeleteId.set(null),this.itemToDeleteName.set(null),this.isDeleting.set(!1)}confirmDeleteItem(){let n=this.config(),t=this.itemToDeleteId();!n||t===null||(this.isDeleting.set(!0),this.apiService.delete(`${n.endpoint}${t}/`).subscribe({next:()=>{this.loadItems(),this.closeDeleteConfirmModal()},error:i=>{let l=i.error&&typeof i.error=="object"?JSON.stringify(i.error):i.message;alert(`Error deleting ${n.itemLabel.toLowerCase()}: ${l||"Please try again."}`),console.error(i),this.isDeleting.set(!1)}}))}hasField(n){return this.config()?.formFields.includes(n)||!1}getTextColor(n){if(!n)return"#000000";try{let t=n.replace("#",""),i=parseInt(t.substring(0,2),16),l=parseInt(t.substring(2,4),16),m=parseInt(t.substring(4,6),16);return .2126*i+.7152*l+.0722*m>128?"#000000":"#FFFFFF"}catch{return"#000000"}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=w({type:e,selectors:[["app-settings-list"]],decls:2,vars:1,consts:[[1,"text-slate-500"],[1,"mb-6","flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-slate-800"],[1,"text-sm","text-slate-500"],[1,"bg-indigo-600","hover:bg-indigo-700","text-white","font-semibold","py-2","px-4","rounded-md","shadow-sm","transition-colors",3,"click"],[1,"text-slate-600"],["role","alert",1,"bg-red-100","border","border-red-400","text-red-700","px-4","py-3","rounded-md"],[1,"text-slate-500","italic"],[1,"bg-white","shadow-md","rounded-lg","overflow-x-auto"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4","transition-opacity","duration-300","ease-in-out",3,"opacity-100","opacity-0"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"min-w-full","divide-y","divide-slate-200"],[1,"bg-slate-50"],["scope","col",1,"px-4","py-3.5","text-left","text-xs","font-semibold","text-slate-500","uppercase","tracking-wider"],[1,"divide-y","divide-slate-200","bg-white"],[1,"px-4","py-4","whitespace-nowrap","text-sm"],[1,"px-4","py-4","whitespace-nowrap","text-sm","font-medium","text-slate-900"],[1,"px-4","py-4","whitespace-nowrap","text-sm","text-slate-500"],[1,"px-4","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"text-indigo-600","hover:text-indigo-900","mr-3",3,"click"],[1,"text-red-600","hover:text-red-900",3,"click"],[1,"inline-block","w-6","h-6","rounded-full","border","border-slate-300"],[1,"px-2","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4","transition-opacity","duration-300","ease-in-out"],[1,"bg-white","p-6","rounded-lg","shadow-xl","max-w-md","w-full","transform","transition-all","duration-300","ease-in-out"],[1,"text-lg","font-medium","text-slate-900","mb-4"],[3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"mt-6","flex","justify-end","space-x-3"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-slate-700","bg-slate-100","hover:bg-slate-200","rounded-md","shadow-sm",3,"click"],["type","submit",1,"px-4","py-2","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700","rounded-md","shadow-sm","disabled:opacity-50",3,"disabled"],["for","itemName",1,"block","text-sm","font-medium","text-slate-700","mb-1"],[1,"text-red-500"],["type","text","id","itemName","formControlName","name",1,"w-full","p-2","border","rounded-md","shadow-sm",3,"ngClass"],[1,"text-xs","text-red-500","mt-1"],["for","itemColor",1,"block","text-sm","font-medium","text-slate-700","mb-1"],[1,"flex","items-center"],["type","color","id","itemColorPicker","formControlName","color",1,"p-1","h-10","w-10","block","bg-white","border","border-gray-300","cursor-pointer","rounded-lg","disabled:opacity-50","disabled:pointer-events-none"],["type","text","id","itemColorText","formControlName","color","placeholder","#RRGGBB",1,"ml-2","w-full","p-2","border","rounded-md","shadow-sm",3,"ngClass"],["for","itemOrder",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["type","number","id","itemOrder","formControlName","order","min","0",1,"w-full","p-2","border","rounded-md","shadow-sm",3,"ngClass"],["type","checkbox","id","itemIsClosed","formControlName","is_closed",1,"h-4","w-4","text-indigo-600","border-slate-300","rounded","focus:ring-indigo-500"],["for","itemIsClosed",1,"ml-2","block","text-sm","text-slate-900"],[1,"text-xs","text-slate-500","mt-1"],[1,"bg-white","p-6","rounded-lg","shadow-xl","max-w-sm","w-full"],[1,"text-lg","font-medium","text-slate-900","mb-2"],[1,"text-sm","text-slate-600","mb-1"],[1,"text-slate-700"],[1,"text-xs","text-red-500","mb-6"],[1,"flex","justify-end","space-x-3"],[1,"px-4","py-2","text-sm","font-medium","text-slate-700","bg-slate-100","hover:bg-slate-200","rounded-md",3,"click","disabled"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700","rounded-md","disabled:opacity-50",3,"click","disabled"]],template:function(t,i){if(t&1&&x(0,kt,14,6)(1,Dt,2,0,"p",0),t&2){let l;c((l=i.config())?0:1,l)}},dependencies:[E,P,Q,B,G,J,q,z,W,H,U,Y],styles:[".fixed.inset-0[_ngcontent-%COMP%]{transition:opacity .3s ease-in-out}.fixed.inset-0[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{transition:transform .3s ease-in-out}"]})};var Xt=[{path:"",component:M,children:[{path:"",redirectTo:"statuses",pathMatch:"full"},{path:"statuses",component:b,data:{settingType:"statuses",title:"Statuses",itemLabel:"Status",endpoint:"/settings/statuses/",formFields:["name","color","order","is_closed"]},title:"Manage Statuses"},{path:"priorities",component:b,data:{settingType:"priorities",title:"Priorities",itemLabel:"Priority",endpoint:"/settings/priorities/",formFields:["name","color","order"]},title:"Manage Priorities"},{path:"severities",component:b,data:{settingType:"severities",title:"Severities",itemLabel:"Severity",endpoint:"/settings/severities/",formFields:["name","color","order"]},title:"Manage Severities"},{path:"types",component:b,data:{settingType:"types",title:"Issue Types",itemLabel:"Issue Type",endpoint:"/settings/types/",formFields:["name","color","order"]},title:"Manage Issue Types"}]}];export{Xt as SETTINGS_ROUTES};
