import{a as L}from"./chunk-NGVF4NNM.js";import{D as m,I as g,J as s,Na as E,O as v,S as u,Y as _,Ya as T,aa as p,ba as b,bb as j,ca as h,da as o,ea as n,fa as C,ia as y,ka as S,la as l,ma as U,na as r,oa as k,pa as w,qa as I,r as d,u as f,v as x}from"./chunk-CUL4UXS2.js";var $=(i,e)=>e.id;function P(i,e){i&1&&(o(0,"p",3),r(1,"Loading users..."),n())}function N(i,e){if(i&1&&(o(0,"div",4)(1,"strong",8),r(2,"Error:"),n(),r(3),n()),i&2){let t=l();s(3),w(" ",t.error()," ")}}function V(i,e){i&1&&(o(0,"p",5),r(1,"No users found."),n())}function D(i,e){if(i&1&&(o(0,"span",14),r(1),n()),i&2){let t=l().$implicit;s(),I("",t.first_name||""," ",t.last_name||"","")}}function M(i,e){i&1&&(o(0,"span",15),r(1,"No API key available"),n())}function O(i,e){if(i&1){let t=y();o(0,"button",10),S("click",function(){let c=f(t).$implicit,F=l(2);return x(F.selectUser(c))}),C(1,"img",11),o(2,"div",12)(3,"span",13),r(4),n(),u(5,D,2,2,"span",14)(6,M,2,0,"span",15),n()()}if(i&2){let t=e.$implicit;_("disabled",!(t.api_key_object!=null&&t.api_key_object.key_display)),s(),U("alt","",t.username,"'s avatar"),_("src",t.avatar_url,g),s(3),k(t.username),s(),p(t.first_name||t.last_name?5:-1),s(),p(t.api_key_object!=null&&t.api_key_object.key_display?-1:6)}}function W(i,e){if(i&1&&(o(0,"div",6),b(1,O,7,7,"button",9,$),n()),i&2){let t=l();s(),h(t.users())}}var A=class i{apiService=d(L);authService=d(j);router=d(T);users=m([]);isLoading=m(!0);error=m(null);ngOnInit(){this.authService.isAuthenticated(),this.loadUsers()}loadUsers(){this.isLoading.set(!0),this.error.set(null),this.apiService.get("/users/").subscribe({next:e=>{console.log(e),this.users.set(e),console.log("signal set",this.users()),this.isLoading.set(!1)},error:e=>{console.error("Failed to load users",e),this.error.set("Could not load user list. Please try again later."),this.isLoading.set(!1)}})}selectUser(e){if(e.api_key_object&&e.api_key_object.key_display){let t={id:e.id,username:e.username,apiKey:e.api_key_object.key_display,avatarUrl:e.avatar_url};this.authService.login(t)}else console.warn(`User ${e.username} does not have an API key to use for login.`),this.error.set(`User ${e.username} does not have an API key. Cannot login.`)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=v({type:i,selectors:[["app-user-select"]],decls:11,vars:1,consts:[[1,"min-h-screen","bg-slate-100","flex","flex-col","items-center","justify-center","p-4"],[1,"w-full","max-w-md"],[1,"text-3xl","font-bold","text-center","text-slate-800","mb-8"],[1,"text-slate-600","text-center"],["role","alert",1,"bg-red-100","border","border-red-400","text-red-700","px-4","py-3","rounded-md","mb-4"],[1,"text-slate-500","text-center","italic"],[1,"space-y-3"],[1,"mt-12","text-center","text-sm","text-slate-500"],[1,"font-bold"],[1,"w-full","flex","items-center","p-4","bg-white","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:ring-opacity-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"w-full","flex","items-center","p-4","bg-white","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:ring-opacity-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"w-10","h-10","rounded-full","object-cover","mr-4","border","border-slate-200",3,"src","alt"],[1,"text-left"],[1,"font-semibold","text-slate-700"],[1,"block","text-xs","text-slate-500"],[1,"block","text-xs","text-red-500","mt-1"]],template:function(t,a){if(t&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Select User to Continue"),n(),u(4,P,2,0,"p",3)(5,N,4,1,"div",4)(6,V,2,0,"p",5)(7,W,3,0,"div",6),n(),o(8,"footer",7)(9,"p"),r(10,"Ventus Issue Tracker - User Selection"),n()()()),t&2){let c;s(4),p(a.isLoading()?4:a.error()?5:(c=a.users())!=null&&c.length?7:6)}},dependencies:[E],encapsulation:2})};export{A as UserSelectComponent};
